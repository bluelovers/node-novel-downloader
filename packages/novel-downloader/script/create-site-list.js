"use strict";
/**
 * Created by user on 2019/1/3/003.
 */
Object.defineProperty(exports, "__esModule", { value: true });
const fg = require("@bluelovers/fast-glob");
const path = require("path");
const fs = require("fs-extra");
const Bluebird = require("bluebird");
const array_hyper_unique_1 = require("array-hyper-unique");
fg.async([
    '*/**.ts',
], {
    cwd: path.join(__dirname, '..', 'src/site'),
    ignore: [
        '**/*.d.ts',
    ],
})
    .then(function (ls) {
    //console.log(ls);
    return ls.sort().reduce(function (a, b) {
        b = b.replace(/\.ts$/, '');
        let basename = path.basename(b);
        let ds = b.split('/');
        let id;
        if (basename == 'index') {
            ds.pop();
        }
        let b2 = ds.join('/');
        ds = ds.map(function (s) {
            return s.replace(/^[a-z]/, function (s) {
                return s.toUpperCase();
            });
        });
        id = [
            'NovelSite',
        ].concat(ds).join('');
        a.push([id, b2]);
        return a;
    }, []);
})
    .then(async (ls) => {
    //console.log(ls);
    let ret = [''];
    let s;
    s = `export enum EnumNovelSiteList
{
	${ls.map(([k, v]) => `${k} = '${v}',`).join('\n\t')}
	${ls.map(([k, v]) => `'${v}' = '${v}',`).join('\n\t')}
	${ls.map(([k, v]) => `'./site/${v}' = '${v}',`).join('\n\t')}
}`;
    ret.push(s);
    await Bluebird.resolve(ls)
        .reduce(async (a, [k, v]) => {
        let IDKEY = await Promise.resolve().then(() => require(`../src/site/${v}`)).then(m => m.default.IDKEY)
            .catch(e => null);
        if (IDKEY) {
            a[0].push(`${k} = '${IDKEY}',`);
            a[1].push(`'${v}' = '${IDKEY}',`);
            a[1].push(`'${IDKEY}' = '${IDKEY}',`);
            a[2].push(`'./site/${v}' = '${IDKEY}',`);
        }
        return a;
    }, [[], [], []])
        .then(a => {
        array_hyper_unique_1.array_unique_overwrite(a[0]);
        array_hyper_unique_1.array_unique_overwrite(a[1]);
        array_hyper_unique_1.array_unique_overwrite(a[2]);
        let s = `export enum EnumIDKEYList
{
	${a[0].join('\n\t')}
	${a[1].join('\n\t')}
	${a[2].join('\n\t')}
}`;
        ret.push(s);
    });
    s = `export interface INovelSiteList
{
	${ls.map(([k, v]) => `${k}: typeof import('../site/${v}').default`).join('\n\t')}
}`;
    ret.push(s);
    await fs.writeFile(path.join(__dirname, '..', 'src/all/const.ts'), ret.join('\n\n'));
    ret = [];
    s = `import _NovelSite from './site';\nimport Bluebird = require("bluebird");`;
    ret.push(s);
    ret.push(`import { EnumNovelSiteList, INovelSiteList } from './all/const';`);
    ret.push(`export { EnumNovelSiteList, INovelSiteList }`);
    s = ls.map(([k, v]) => `export function requireNovelSiteClass(siteID: EnumNovelSiteList.${k} | '${v}'): INovelSiteList["${k}"]\n`).join('');
    s += `export function requireNovelSiteClass\<T extends typeof _NovelSite\>(siteID: EnumNovelSiteList | string): T
export function requireNovelSiteClass(siteID: EnumNovelSiteList | string)
{
	if (!(siteID in EnumNovelSiteList))
	{
		throw new RangeError(\`'\${siteID}' not exists\`);
	}
	return require(\`./site/\$\{EnumNovelSiteList[siteID]\}\`).default
}`;
    ret.push(s);
    s = `export default requireNovelSiteClass`;
    ret.push(s);
    ret.push('');
    return fs.writeFile(path.join(__dirname, '..', 'src/all.ts'), ret.join('\n\n'));
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3JlYXRlLXNpdGUtbGlzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImNyZWF0ZS1zaXRlLWxpc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBOztHQUVHOztBQUVILDRDQUE2QztBQUM3Qyw2QkFBOEI7QUFDOUIsK0JBQWdDO0FBQ2hDLHFDQUFzQztBQUN0QywyREFBNEQ7QUFFNUQsRUFBRSxDQUFDLEtBQUssQ0FBUztJQUNoQixTQUFTO0NBQ1QsRUFBRTtJQUNGLEdBQUcsRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxJQUFJLEVBQUUsVUFBVSxDQUFDO0lBQzNDLE1BQU0sRUFBRTtRQUNQLFdBQVc7S0FDWDtDQUNELENBQUM7S0FDQSxJQUFJLENBQUMsVUFBVSxFQUFFO0lBRWpCLGtCQUFrQjtJQUVsQixPQUFPLEVBQUUsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FBQztRQUVyQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFFM0IsSUFBSSxRQUFRLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNoQyxJQUFJLEVBQUUsR0FBRyxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBRXRCLElBQUksRUFBVSxDQUFDO1FBRWYsSUFBSSxRQUFRLElBQUksT0FBTyxFQUN2QjtZQUNDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQztTQUNUO1FBRUQsSUFBSSxFQUFFLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUV0QixFQUFFLEdBQUcsRUFBRSxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUM7WUFFdEIsT0FBTyxDQUFDLENBQUMsT0FBTyxDQUFDLFFBQVEsRUFBRSxVQUFVLENBQUM7Z0JBRXJDLE9BQU8sQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lB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QUFDO0lBRVosR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUViLE9BQU8sRUFBRSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxJQUFJLEVBQUUsWUFBWSxDQUFDLEVBQUUsR0FBRyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO0FBQ2pGLENBQUMsQ0FBQyxDQUNGIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDcmVhdGVkIGJ5IHVzZXIgb24gMjAxOS8xLzMvMDAzLlxuICovXG5cbmltcG9ydCBmZyA9IHJlcXVpcmUoXCJAYmx1ZWxvdmVycy9mYXN0LWdsb2JcIik7XG5pbXBvcnQgcGF0aCA9IHJlcXVpcmUoXCJwYXRoXCIpO1xuaW1wb3J0IGZzID0gcmVxdWlyZShcImZzLWV4dHJhXCIpO1xuaW1wb3J0IEJsdWViaXJkID0gcmVxdWlyZShcImJsdWViaXJkXCIpO1xuaW1wb3J0IHsgYXJyYXlfdW5pcXVlX292ZXJ3cml0ZSB9IGZyb20gJ2FycmF5LWh5cGVyLXVuaXF1ZSc7XG5cbmZnLmFzeW5jPHN0cmluZz4oW1xuXHQnKi8qKi50cycsXG5dLCB7XG5cdGN3ZDogcGF0aC5qb2luKF9fZGlybmFtZSwgJy4uJywgJ3NyYy9zaXRlJyksXG5cdGlnbm9yZTogW1xuXHRcdCcqKi8qLmQudHMnLFxuXHRdLFxufSlcblx0LnRoZW4oZnVuY3Rpb24gKGxzKVxuXHR7XG5cdFx0Ly9jb25zb2xlLmxvZyhscyk7XG5cblx0XHRyZXR1cm4gbHMuc29ydCgpLnJlZHVjZShmdW5jdGlvbiAoYSwgYilcblx0XHR7XG5cdFx0XHRiID0gYi5yZXBsYWNlKC9cXC50cyQvLCAnJyk7XG5cblx0XHRcdGxldCBiYXNlbmFtZSA9IHBhdGguYmFzZW5hbWUoYik7XG5cdFx0XHRsZXQgZHMgPSBiLnNwbGl0KCcvJyk7XG5cblx0XHRcdGxldCBpZDogc3RyaW5nO1xuXG5cdFx0XHRpZiAoYmFzZW5hbWUgPT0gJ2luZGV4Jylcblx0XHRcdHtcblx0XHRcdFx0ZHMucG9wKCk7XG5cdFx0XHR9XG5cblx0XHRcdGxldCBiMiA9IGRzLmpvaW4oJy8nKTtcblxuXHRcdFx0ZHMgPSBkcy5tYXAoZnVuY3Rpb24gKHMpXG5cdFx0XHR7XG5cdFx0XHRcdHJldHVybiBzLnJlcGxhY2UoL15bYS16XS8sIGZ1bmN0aW9uIChzKVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0cmV0dXJuIHMudG9VcHBlckNhc2UoKTtcblx0XHRcdFx0fSlcblx0XHRcdH0pO1xuXG5cdFx0XHRpZCA9IFtcblx0XHRcdFx0J05vdmVsU2l0ZScsXG5cdFx0XHRdLmNvbmNhdChkcykuam9pbignJyk7XG5cblx0XHRcdGEucHVzaChbaWQsIGIyXSk7XG5cblx0XHRcdHJldHVybiBhO1xuXHRcdH0sIFtdKVxuXHR9KVxuXHQudGhlbihhc3luYyAobHMpID0+IHtcblx0XHQvL2NvbnNvbGUubG9nKGxzKTtcblxuXHRcdGxldCByZXQ6IHN0cmluZ1tdID0gWycnXTtcblxuXHRcdGxldCBzOiBzdHJpbmc7XG5cblx0XHRzID0gYGV4cG9ydCBlbnVtIEVudW1Ob3ZlbFNpdGVMaXN0XG57XG5cdCR7bHMubWFwKChbaywgdl0pID0+IGAke2t9ID0gJyR7dn0nLGApLmpvaW4oJ1xcblxcdCcpfVxuXHQke2xzLm1hcCgoW2ssIHZdKSA9PiBgJyR7dn0nID0gJyR7dn0nLGApLmpvaW4oJ1xcblxcdCcpfVxuXHQke2xzLm1hcCgoW2ssIHZdKSA9PiBgJy4vc2l0ZS8ke3Z9JyA9ICcke3Z9JyxgKS5qb2luKCdcXG5cXHQnKX1cbn1gO1xuXG5cdFx0cmV0LnB1c2gocyk7XG5cblx0XHRhd2FpdCBCbHVlYmlyZC5yZXNvbHZlKGxzKVxuXHRcdFx0LnJlZHVjZShhc3luYyAoYSwgW2ssIHZdKSA9PiB7XG5cblx0XHRcdFx0bGV0IElES0VZID0gYXdhaXQgaW1wb3J0KGAuLi9zcmMvc2l0ZS8ke3Z9YClcblx0XHRcdFx0XHQudGhlbihtID0+IG0uZGVmYXVsdC5JREtFWSlcblx0XHRcdFx0XHQuY2F0Y2goZSA9PiBudWxsKVxuXHRcdFx0XHQ7XG5cblx0XHRcdFx0aWYgKElES0VZKVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0YVswXS5wdXNoKGAke2t9ID0gJyR7SURLRVl9JyxgKTtcblx0XHRcdFx0XHRhWzFdLnB1c2goYCcke3Z9JyA9ICcke0lES0VZfScsYCk7XG5cdFx0XHRcdFx0YVsxXS5wdXNoKGAnJHtJREtFWX0nID0gJyR7SURLRVl9JyxgKTtcblx0XHRcdFx0XHRhWzJdLnB1c2goYCcuL3NpdGUvJHt2fScgPSAnJHtJREtFWX0nLGApO1xuXG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXR1cm4gYVxuXHRcdFx0fSwgW1tdLCBbXSwgW11dKVxuXHRcdFx0LnRoZW4oYSA9PiB7XG5cblx0XHRcdFx0YXJyYXlfdW5pcXVlX292ZXJ3cml0ZShhWzBdKTtcblx0XHRcdFx0YXJyYXlfdW5pcXVlX292ZXJ3cml0ZShhWzFdKTtcblx0XHRcdFx0YXJyYXlfdW5pcXVlX292ZXJ3cml0ZShhWzJdKTtcblxuXHRcdFx0XHRsZXQgcyA9IGBleHBvcnQgZW51bSBFbnVtSURLRVlMaXN0XG57XG5cdCR7YVswXS5qb2luKCdcXG5cXHQnKX1cblx0JHthWzFdLmpvaW4oJ1xcblxcdCcpfVxuXHQke2FbMl0uam9pbignXFxuXFx0Jyl9XG59YDtcblxuXHRcdFx0XHRyZXQucHVzaChzKTtcblxuXHRcdFx0fSlcblx0XHQ7XG5cblx0XHRzID0gYGV4cG9ydCBpbnRlcmZhY2UgSU5vdmVsU2l0ZUxpc3Rcbntcblx0JHtscy5tYXAoKFtrLCB2XSkgPT4gYCR7a306IHR5cGVvZiBpbXBvcnQoJy4uL3NpdGUvJHt2fScpLmRlZmF1bHRgKS5qb2luKCdcXG5cXHQnKX1cbn1gO1xuXG5cdFx0cmV0LnB1c2gocyk7XG5cblx0XHRhd2FpdCBmcy53cml0ZUZpbGUocGF0aC5qb2luKF9fZGlybmFtZSwgJy4uJywgJ3NyYy9hbGwvY29uc3QudHMnKSwgcmV0LmpvaW4oJ1xcblxcbicpKTtcblxuXHRcdHJldCA9IFtdO1xuXG5cdFx0cyA9IGBpbXBvcnQgX05vdmVsU2l0ZSBmcm9tICcuL3NpdGUnO1xcbmltcG9ydCBCbHVlYmlyZCA9IHJlcXVpcmUoXCJibHVlYmlyZFwiKTtgO1xuXG5cdFx0cmV0LnB1c2gocyk7XG5cblx0XHRyZXQucHVzaChgaW1wb3J0IHsgRW51bU5vdmVsU2l0ZUxpc3QsIElOb3ZlbFNpdGVMaXN0IH0gZnJvbSAnLi9hbGwvY29uc3QnO2ApO1xuXHRcdHJldC5wdXNoKGBleHBvcnQgeyBFbnVtTm92ZWxTaXRlTGlzdCwgSU5vdmVsU2l0ZUxpc3QgfWApO1xuXG5cdFx0cyA9IGxzLm1hcCgoW2ssIHZdKSA9PiBgZXhwb3J0IGZ1bmN0aW9uIHJlcXVpcmVOb3ZlbFNpdGVDbGFzcyhzaXRlSUQ6IEVudW1Ob3ZlbFNpdGVMaXN0LiR7a30gfCAnJHt2fScpOiBJTm92ZWxTaXRlTGlzdFtcIiR7a31cIl1cXG5gKS5qb2luKCcnKTtcblxuXHRcdHMgKz0gYGV4cG9ydCBmdW5jdGlvbiByZXF1aXJlTm92ZWxTaXRlQ2xhc3NcXDxUIGV4dGVuZHMgdHlwZW9mIF9Ob3ZlbFNpdGVcXD4oc2l0ZUlEOiBFbnVtTm92ZWxTaXRlTGlzdCB8IHN0cmluZyk6IFRcbmV4cG9ydCBmdW5jdGlvbiByZXF1aXJlTm92ZWxTaXRlQ2xhc3Moc2l0ZUlEOiBFbnVtTm92ZWxTaXRlTGlzdCB8IHN0cmluZylcbntcblx0aWYgKCEoc2l0ZUlEIGluIEVudW1Ob3ZlbFNpdGVMaXN0KSlcblx0e1xuXHRcdHRocm93IG5ldyBSYW5nZUVycm9yKFxcYCdcXCR7c2l0ZUlEfScgbm90IGV4aXN0c1xcYCk7XG5cdH1cblx0cmV0dXJuIHJlcXVpcmUoXFxgLi9zaXRlL1xcJFxce0VudW1Ob3ZlbFNpdGVMaXN0W3NpdGVJRF1cXH1cXGApLmRlZmF1bHRcbn1gO1xuXG5cdFx0cmV0LnB1c2gocyk7XG5cblx0XHRzID0gYGV4cG9ydCBkZWZhdWx0IHJlcXVpcmVOb3ZlbFNpdGVDbGFzc2A7XG5cblx0XHRyZXQucHVzaChzKTtcblxuXHRcdHJldC5wdXNoKCcnKTtcblxuXHRcdHJldHVybiBmcy53cml0ZUZpbGUocGF0aC5qb2luKF9fZGlybmFtZSwgJy4uJywgJ3NyYy9hbGwudHMnKSwgcmV0LmpvaW4oJ1xcblxcbicpKTtcblx0fSlcbjtcbiJdfQ==