"use strict";
/// <reference types="jquery" />
Object.defineProperty(exports, "__esModule", { value: true });
const hash_1 = require("./hash");
function keepFormatTag(target, opts) {
    let { optionsRuntime, $ } = opts;
    let _target = $(target);
    if (optionsRuntime.keepRuby) {
        [
            'rp',
            'rt',
            'ruby',
        ].forEach(tag => {
            _tagToFormat(_target, tag, $);
        });
    }
    if (optionsRuntime.keepFormat) {
        [
            's',
            'i',
            'b',
            'sup',
            'sub',
        ].forEach(tag => {
            _tagToFormat(_target, tag, $);
        });
    }
    return _target;
}
exports.keepFormatTag = keepFormatTag;
function _keepImageInContext(_imgs, $, prefix = '插圖') {
    _imgs.each((i, elem) => {
        let img = $(elem);
        let src = img.prop('src');
        img.after(`（${prefix}${hash_1.hashSum(src)}）`);
        img.remove();
    });
    return _imgs;
}
exports._keepImageInContext = _keepImageInContext;
function _tagToFormat(_target, tag, $) {
    _target.find(tag)
        .each((i, elem) => {
        let _this = $(elem);
        _this.after(`＜${tag}＞${_this.html()}＜/${tag}＞`);
        _this.remove();
    });
    return _target;
}
exports._tagToFormat = _tagToFormat;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaHRtbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImh0bWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLGdDQUFnQzs7QUFHaEMsaUNBQWlDO0FBRWpDLFNBQWdCLGFBQWEsQ0FBNEUsTUFBUyxFQUFFLElBR25IO0lBRUEsSUFBSSxFQUFFLGNBQWMsRUFBRSxDQUFDLEVBQUUsR0FBRyxJQUFJLENBQUM7SUFFakMsSUFBSSxPQUFPLEdBQVcsQ0FBQyxDQUFDLE1BQXFCLENBQUMsQ0FBQztJQUUvQyxJQUFJLGNBQWMsQ0FBQyxRQUFRLEVBQzNCO1FBQ0M7WUFDQyxJQUFJO1lBQ0osSUFBSTtZQUNKLE1BQU07U0FDTixDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsRUFBRTtZQUVmLFlBQVksQ0FBQyxPQUFPLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFBO1FBQzlCLENBQUMsQ0FBQyxDQUNEO0tBQ0Q7SUFFRCxJQUFJLGNBQWMsQ0FBQyxVQUFVLEVBQzdCO1FBQ0M7WUFDQyxHQUFHO1lBQ0gsR0FBRztZQUNILEdBQUc7WUFDSCxLQUFLO1lBQ0wsS0FBSztTQUNMLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxFQUFFO1lBRWYsWUFBWSxDQUFDLE9BQU8sRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUE7UUFDOUIsQ0FBQyxDQUFDLENBQ0Q7S0FDRDtJQUVELE9BQU8sT0FBTyxDQUFBO0FBQ2YsQ0FBQztBQXRDRCxzQ0FzQ0M7QUFFRCxTQUFnQixtQkFBbUIsQ0FBQyxLQUFhLEVBQUUsQ0FBZSxFQUFFLE1BQU0sR0FBRyxJQUFJO0lBRWhGLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsSUFBSSxFQUFFLEVBQUU7UUFFdEIsSUFBSSxHQUFHLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ2xCLElBQUksR0FBRyxHQUFHLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFFMUIsR0FBRyxDQUFDLEtBQUssQ0FBQyxJQUFJLE1BQU0sR0FBRyxjQUFPLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3hDLEdBQUcsQ0FBQyxNQUFNLEVBQUUsQ0FBQztJQUVkLENBQUMsQ0FBQyxDQUFDO0lBRUgsT0FBTyxLQUFLLENBQUM7QUFDZCxDQUFDO0FBYkQsa0RBYUM7QUFFRCxTQUFnQixZQUFZLENBQUMsT0FBZSxFQUFFLEdBQVcsRUFBRSxDQUFlO0lBRXpFLE9BQU8sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDO1NBQ2YsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLElBQUksRUFBRSxFQUFFO1FBRWpCLElBQUksS0FBSyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUVwQixLQUFLLENBQUMsS0FBSyxDQUFDLElBQUksR0FBRyxJQUFJLEtBQUssQ0FBQyxJQUFJLEVBQUUsS0FBSyxHQUFHLEdBQUcsQ0FBQyxDQUFDO1FBQ2hELEtBQUssQ0FBQyxNQUFNLEVBQUUsQ0FBQztJQUVoQixDQUFDLENBQUMsQ0FDRjtJQUVELE9BQU8sT0FBTyxDQUFDO0FBQ2hCLENBQUM7QUFkRCxvQ0FjQyIsInNvdXJjZXNDb250ZW50IjpbIi8vLyA8cmVmZXJlbmNlIHR5cGVzPVwianF1ZXJ5XCIgLz5cblxuaW1wb3J0IE5vdmVsU2l0ZSBmcm9tICcuLi9zaXRlL2luZGV4JztcbmltcG9ydCB7IGhhc2hTdW0gfSBmcm9tICcuL2hhc2gnO1xuXG5leHBvcnQgZnVuY3Rpb24ga2VlcEZvcm1hdFRhZzxPID0gTm92ZWxTaXRlLklPcHRpb25zUnVudGltZSwgRSBleHRlbmRzIHVua25vd24gfCBKUXVlcnlTdGF0aWMgPSB1bmtub3duPih0YXJnZXQ6IEUsIG9wdHM6IHtcblx0JDogSlF1ZXJ5U3RhdGljLFxuXHRvcHRpb25zUnVudGltZTogTyAmIE5vdmVsU2l0ZS5JT3B0aW9uc1J1bnRpbWUsXG59KVxue1xuXHRsZXQgeyBvcHRpb25zUnVudGltZSwgJCB9ID0gb3B0cztcblxuXHRsZXQgX3RhcmdldDogSlF1ZXJ5ID0gJCh0YXJnZXQgYXMgSFRNTEVsZW1lbnQpO1xuXG5cdGlmIChvcHRpb25zUnVudGltZS5rZWVwUnVieSlcblx0e1xuXHRcdFtcblx0XHRcdCdycCcsXG5cdFx0XHQncnQnLFxuXHRcdFx0J3J1YnknLFxuXHRcdF0uZm9yRWFjaCh0YWcgPT5cblx0XHR7XG5cdFx0XHRfdGFnVG9Gb3JtYXQoX3RhcmdldCwgdGFnLCAkKVxuXHRcdH0pXG5cdFx0O1xuXHR9XG5cblx0aWYgKG9wdGlvbnNSdW50aW1lLmtlZXBGb3JtYXQpXG5cdHtcblx0XHRbXG5cdFx0XHQncycsXG5cdFx0XHQnaScsXG5cdFx0XHQnYicsXG5cdFx0XHQnc3VwJyxcblx0XHRcdCdzdWInLFxuXHRcdF0uZm9yRWFjaCh0YWcgPT5cblx0XHR7XG5cdFx0XHRfdGFnVG9Gb3JtYXQoX3RhcmdldCwgdGFnLCAkKVxuXHRcdH0pXG5cdFx0O1xuXHR9XG5cblx0cmV0dXJuIF90YXJnZXRcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9rZWVwSW1hZ2VJbkNvbnRleHQoX2ltZ3M6IEpRdWVyeSwgJDogSlF1ZXJ5U3RhdGljLCBwcmVmaXggPSAn5o+S5ZyWJylcbntcblx0X2ltZ3MuZWFjaCgoaSwgZWxlbSkgPT4ge1xuXG5cdFx0bGV0IGltZyA9ICQoZWxlbSk7XG5cdFx0bGV0IHNyYyA9IGltZy5wcm9wKCdzcmMnKTtcblxuXHRcdGltZy5hZnRlcihg77yIJHtwcmVmaXh9JHtoYXNoU3VtKHNyYyl977yJYCk7XG5cdFx0aW1nLnJlbW92ZSgpO1xuXG5cdH0pO1xuXG5cdHJldHVybiBfaW1ncztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF90YWdUb0Zvcm1hdChfdGFyZ2V0OiBKUXVlcnksIHRhZzogc3RyaW5nLCAkOiBKUXVlcnlTdGF0aWMpXG57XG5cdF90YXJnZXQuZmluZCh0YWcpXG5cdFx0LmVhY2goKGksIGVsZW0pID0+XG5cdFx0e1xuXHRcdFx0bGV0IF90aGlzID0gJChlbGVtKTtcblxuXHRcdFx0X3RoaXMuYWZ0ZXIoYO+8nCR7dGFnfe+8niR7X3RoaXMuaHRtbCgpfe+8nC8ke3RhZ33vvJ5gKTtcblx0XHRcdF90aGlzLnJlbW92ZSgpO1xuXG5cdFx0fSlcblx0O1xuXG5cdHJldHVybiBfdGFyZ2V0O1xufVxuIl19