"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const url_1 = require("../../util/url");
function check(url, options) {
    return /wenku8/i.test(url_1.default(url).hostname || '');
}
exports.check = check;
function makeUrl(urlobj, bool, ...argv) {
    let url;
    if (bool < 0) {
        url = `http://www.wenku8.com/book/${urlobj.novel_id}.htm`;
    }
    else {
        let cid = (!bool && urlobj.chapter_id) ? '&cid=' + urlobj.chapter_id : '';
        url = `http://www.wenku8.com/modules/article/reader.php?aid=${urlobj.novel_id}${cid}`;
    }
    return url_1.default(url);
}
exports.makeUrl = makeUrl;
function parseUrl(_url, ...argv) {
    const { urlobj, url } = url_1._handleParseURL(_url, ...argv);
    let r;
    let m;
    r = /modules\/article\/articleinfo\.php\?id=(\d+)/;
    if (m = r.exec(url)) {
        urlobj.novel_id = m[1];
        return urlobj;
    }
    r = /modules\/article\/reader\.php\?aid=(\d+)(?:&cid=(\d+))?/;
    if (m = r.exec(url)) {
        urlobj.novel_id = m[1];
        urlobj.chapter_id = m[2];
        return urlobj;
    }
    r = /book\/(\d+)\.htm/;
    if (m = r.exec(url)) {
        urlobj.novel_id = m[1];
        return urlobj;
    }
    r = /novel\/([\d]+)\/([\d]+)\/(?:([\d]+)\.html?)?/;
    if (m = r.exec(url)) {
        urlobj.novel_pid = m[1];
        urlobj.novel_id = m[2];
        urlobj.chapter_id = m[3];
    }
    r = /^(\d+)$/;
    if (m = r.exec(url)) {
        urlobj.novel_id = m[1];
        return urlobj;
    }
    return urlobj;
}
exports.parseUrl = parseUrl;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInV0aWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFDQSx3Q0FBOEU7QUFFOUUsU0FBZ0IsS0FBSyxDQUFDLEdBQXVDLEVBQUUsT0FBUTtJQUV0RSxPQUFPLFNBQVMsQ0FBQyxJQUFJLENBQUMsYUFBUyxDQUFDLEdBQVUsQ0FBQyxDQUFDLFFBQVEsSUFBSSxFQUFFLENBQUMsQ0FBQztBQUM3RCxDQUFDO0FBSEQsc0JBR0M7QUFFRCxTQUFnQixPQUFPLENBQUMsTUFBMkIsRUFBRSxJQUF3QixFQUFFLEdBQUcsSUFBSTtJQUVyRixJQUFJLEdBQVcsQ0FBQztJQUVoQixJQUFJLElBQUksR0FBRyxDQUFDLEVBQ1o7UUFDQyxHQUFHLEdBQUcsOEJBQThCLE1BQU0sQ0FBQyxRQUFRLE1BQU0sQ0FBQztLQUMxRDtTQUVEO1FBQ0MsSUFBSSxHQUFHLEdBQUcsQ0FBQyxDQUFDLElBQUksSUFBSSxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sR0FBRyxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7UUFFMUUsR0FBRyxHQUFHLHdEQUF3RCxNQUFNLENBQUMsUUFBUSxHQUFHLEdBQUcsRUFBRSxDQUFDO0tBQ3RGO0lBRUQsT0FBTyxhQUFTLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDdkIsQ0FBQztBQWhCRCwwQkFnQkM7QUFFRCxTQUFnQixRQUFRLENBQUMsSUFBMkIsRUFBRSxHQUFHLElBQUk7SUFFNUQsTUFBTSxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUUsR0FBRyxxQkFBZSxDQUFDLElBQUksRUFBRSxHQUFHLElBQUksQ0FBQyxDQUFDO0lBRXZELElBQUksQ0FBUyxDQUFDO0lBQ2QsSUFBSSxDQUFrQixDQUFDO0lBRXZCLENBQUMsR0FBRyw4Q0FBOEMsQ0FBQztJQUNuRCxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUNuQjtRQUNDLE1BQU0sQ0FBQyxRQUFRLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBRXZCLE9BQU8sTUFBTSxDQUFDO0tBQ2Q7SUFFRCxDQUFDLEdBQUcseURBQXlELENBQUM7SUFDOUQsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsRUFDbkI7UUFDQyxNQUFNLENBQUMsUUFBUSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN2QixNQUFNLENBQUMsVUFBVSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUV6QixPQUFPLE1BQU0sQ0FBQztLQUNkO0lBRUQsQ0FBQyxHQUFHLGtCQUFrQixDQUFDO0lBQ3ZCLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQ25CO1FBQ0MsTUFBTSxDQUFDLFFBQVEsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFdkIsT0FBTyxNQUFNLENBQUM7S0FDZDtJQUVELENBQUMsR0FBRyw4Q0FBOEMsQ0FBQztJQUNuRCxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUNuQjtRQUNDLE1BQU0sQ0FBQyxTQUFTLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3hCLE1BQU0sQ0FBQyxRQUFRLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3ZCLE1BQU0sQ0FBQyxVQUFVLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0tBQ3pCO0lBRUQsQ0FBQyxHQUFHLFNBQVMsQ0FBQztJQUNkLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQ25CO1FBQ0MsTUFBTSxDQUFDLFFBQVEsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFdkIsT0FBTyxNQUFNLENBQUM7S0FDZDtJQUVELE9BQU8sTUFBTSxDQUFDO0FBQ2YsQ0FBQztBQWpERCw0QkFpREMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSBOb3ZlbFNpdGUgZnJvbSAnLi4vaW5kZXgnO1xuaW1wb3J0IGNyZWF0ZVVSTCwgeyBfaGFuZGxlUGFyc2VVUkwsIElQYXJzZVVybFJ1bnRpbWUgfSBmcm9tICcuLi8uLi91dGlsL3VybCc7XG5cbmV4cG9ydCBmdW5jdGlvbiBjaGVjayh1cmw6IHN0cmluZyB8IFVSTCB8IE5vdmVsU2l0ZS5JUGFyc2VVcmwsIG9wdGlvbnM/KTogYm9vbGVhblxue1xuXHRyZXR1cm4gL3dlbmt1OC9pLnRlc3QoY3JlYXRlVVJMKHVybCBhcyBhbnkpLmhvc3RuYW1lIHx8ICcnKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1ha2VVcmwodXJsb2JqOiBOb3ZlbFNpdGUuSVBhcnNlVXJsLCBib29sID86IGJvb2xlYW4gfCBudW1iZXIsIC4uLmFyZ3YpXG57XG5cdGxldCB1cmw6IHN0cmluZztcblxuXHRpZiAoYm9vbCA8IDApXG5cdHtcblx0XHR1cmwgPSBgaHR0cDovL3d3dy53ZW5rdTguY29tL2Jvb2svJHt1cmxvYmoubm92ZWxfaWR9Lmh0bWA7XG5cdH1cblx0ZWxzZVxuXHR7XG5cdFx0bGV0IGNpZCA9ICghYm9vbCAmJiB1cmxvYmouY2hhcHRlcl9pZCkgPyAnJmNpZD0nICsgdXJsb2JqLmNoYXB0ZXJfaWQgOiAnJztcblxuXHRcdHVybCA9IGBodHRwOi8vd3d3Lndlbmt1OC5jb20vbW9kdWxlcy9hcnRpY2xlL3JlYWRlci5waHA/YWlkPSR7dXJsb2JqLm5vdmVsX2lkfSR7Y2lkfWA7XG5cdH1cblxuXHRyZXR1cm4gY3JlYXRlVVJMKHVybCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVVybChfdXJsOiBzdHJpbmcgfCBVUkwgfCBudW1iZXIsIC4uLmFyZ3YpXG57XG5cdGNvbnN0IHsgdXJsb2JqLCB1cmwgfSA9IF9oYW5kbGVQYXJzZVVSTChfdXJsLCAuLi5hcmd2KTtcblxuXHRsZXQgcjogUmVnRXhwO1xuXHRsZXQgbTogUmVnRXhwRXhlY0FycmF5O1xuXG5cdHIgPSAvbW9kdWxlc1xcL2FydGljbGVcXC9hcnRpY2xlaW5mb1xcLnBocFxcP2lkPShcXGQrKS87XG5cdGlmIChtID0gci5leGVjKHVybCkpXG5cdHtcblx0XHR1cmxvYmoubm92ZWxfaWQgPSBtWzFdO1xuXG5cdFx0cmV0dXJuIHVybG9iajtcblx0fVxuXG5cdHIgPSAvbW9kdWxlc1xcL2FydGljbGVcXC9yZWFkZXJcXC5waHBcXD9haWQ9KFxcZCspKD86JmNpZD0oXFxkKykpPy87XG5cdGlmIChtID0gci5leGVjKHVybCkpXG5cdHtcblx0XHR1cmxvYmoubm92ZWxfaWQgPSBtWzFdO1xuXHRcdHVybG9iai5jaGFwdGVyX2lkID0gbVsyXTtcblxuXHRcdHJldHVybiB1cmxvYmo7XG5cdH1cblxuXHRyID0gL2Jvb2tcXC8oXFxkKylcXC5odG0vO1xuXHRpZiAobSA9IHIuZXhlYyh1cmwpKVxuXHR7XG5cdFx0dXJsb2JqLm5vdmVsX2lkID0gbVsxXTtcblxuXHRcdHJldHVybiB1cmxvYmo7XG5cdH1cblxuXHRyID0gL25vdmVsXFwvKFtcXGRdKylcXC8oW1xcZF0rKVxcLyg/OihbXFxkXSspXFwuaHRtbD8pPy87XG5cdGlmIChtID0gci5leGVjKHVybCkpXG5cdHtcblx0XHR1cmxvYmoubm92ZWxfcGlkID0gbVsxXTtcblx0XHR1cmxvYmoubm92ZWxfaWQgPSBtWzJdO1xuXHRcdHVybG9iai5jaGFwdGVyX2lkID0gbVszXTtcblx0fVxuXG5cdHIgPSAvXihcXGQrKSQvO1xuXHRpZiAobSA9IHIuZXhlYyh1cmwpKVxuXHR7XG5cdFx0dXJsb2JqLm5vdmVsX2lkID0gbVsxXTtcblxuXHRcdHJldHVybiB1cmxvYmo7XG5cdH1cblxuXHRyZXR1cm4gdXJsb2JqO1xufVxuIl19